steps:
  - task: UsePythonVersion@0
    displayName: 'Use Python $(python.version)'
    inputs:
      versionSpec: '$(python.version)'
  - script: |
      pip install --upgrade pip
      curl -sSL https://raw.githubusercontent.com/sdispater/poetry/master/get-poetry.py | python
    displayName: Install Poetry
  - script: $HOME/.poetry/bin/poetry install -vvv -E dev
    condition: eq( variables['Agent.OS'], 'Linux' )
    displayName: Install all packages (Linux)
  - script: |
      $HOME/.poetry/bin/poetry install -vvv
      export CC=gcc-5; export CXX=g++-5; $HOME/.poetry/bin/poetry install -vvv -E dev
    condition: eq( variables['Agent.OS'], 'Darwin' )
    displayName: Install all packages (MacOS)